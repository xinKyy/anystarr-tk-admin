(this["webpackJsonpreact-admin"]=this["webpackJsonpreact-admin"]||[]).push([[60],{1800:function(e,t,a){"use strict";a.r(t);a(54);var n=a(55),r=a.n(n),c=(a(76),a(78)),l=a.n(c),o=a(62),i=(a(86),a(87)),u=a.n(i),s=(a(349),a(351)),d=a.n(s),m=(a(197),a(198)),p=a.n(m),f=(a(447),a(393)),g=a.n(f),E=(a(57),a(59)),h=a.n(E),b=(a(398),a(307)),y=a.n(b),v=(a(69),a(70)),O=a.n(v),j=(a(58),a(60)),x=a.n(j),S=(a(51),a(50)),C=a.n(S),I=(a(72),a(66)),N=a.n(I),P=a(1777),k=(a(65),a(67)),T=a.n(k),w=a(53),F=(a(63),a(61)),A=a.n(F),R=a(0),U=a.n(R),z=a(73),D=a.n(z),L=a(71),B=a(1850),H=a(434),J=a(315),_=a(56),q=a(1286),M=A.a.Option,V=function(e){var t=e.changeSearch,a=(e.loading,e.onSuccess),n=e.editRecord,r=e.onEditRecordChange,c=e.onTypeChange,l=e.onSearch,o=T.a.useForm(),i=Object(w.a)(o,1)[0],s=T.a.useForm(),m=Object(w.a)(s,1)[0],f=Object(R.useState)(!1),E=Object(w.a)(f,2),b=E[0],v=E[1],j=Object(R.useState)([]),S=Object(w.a)(j,2),I=S[0],k=S[1],F=Object(R.useState)([]),z=Object(w.a)(F,2),D=z[0],L=z[1],V=Object(R.useState)(""),W=Object(w.a)(V,2),G=W[0],K=W[1],Q=Object(R.useState)(!1),X=Object(w.a)(Q,2),Y=X[0],Z=X[1],$=Object(R.useState)(null),ee=Object(w.a)($,2),te=ee[0],ae=ee[1],ne=Object(R.useState)(""),re=Object(w.a)(ne,2),ce=re[0],le=re[1];Object(R.useEffect)((function(){n&&oe(n)}),[n]);var oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;v(!0),e?(Z(!0),ae(e),m.setFieldsValue({pageName:e.sectionName,position:1===e.sectionType,url:e.url}),Array.isArray(e.products)&&L(e.products.map((function(e){return e.productId})))):(Z(!1),ae(null))},ie=function(){G.trim()&&(L([].concat(Object(P.a)(D),[G.trim()])),K(""),m.setFieldsValue({pid:""}))};return U.a.createElement(U.a.Fragment,null,U.a.createElement(T.a,{form:i,name:"advanced_search",className:"ant-advanced-search-form",onFinish:function(e){t(e)}},U.a.createElement(h.a,{justify:"space-between",align:"middle"},U.a.createElement(x.a,null,U.a.createElement(C.a,{type:"primary",icon:U.a.createElement(B.a,null),onClick:function(){return oe()}},"Create Page")),U.a.createElement(x.a,null,U.a.createElement(y.a,null,U.a.createElement(O.a,{placeholder:"Search by name",style:{width:200,fontWeight:"normal",borderRadius:"5px",border:"1px solid #e5ecfc",color:"#333"},prefix:U.a.createElement(H.a,{style:{color:"#d9d9d9"}}),className:"custom-input",onBlur:function(e){var t=e.target.value;l(t)}}),U.a.createElement(A.a,{style:{width:200},placeholder:"All",value:ce,onChange:function(e){le(e),c(e)}},U.a.createElement(M,{value:""},"All"),U.a.createElement(M,{value:"1"},"Home List"),U.a.createElement(M,{value:"2"},"Empty")))))),U.a.createElement(u.a,{title:Y?"Edit Collection Page":"Create Collection Page",visible:b,onOk:function(){m.validateFields().then((function(e){var t={sectionName:e.pageName,sectionType:e.position?1:2,productIds:D,url:e.url||""};Y?(t.id=te.id,Object(_.pc)(JSON.stringify(t)).then((function(e){N.a.success("Update successfully"),v(!1),m.resetFields(),L([]),K(""),Z(!1),ae(null),a()})).catch((function(e){N.a.error("Update failed")}))):Object(_.oc)(JSON.stringify(t)).then((function(e){N.a.success("Create successfully"),v(!1),m.resetFields(),L([]),K(""),Z(!1),ae(null),a()})).catch((function(e){N.a.error("Create failed")}))}))},onCancel:function(){v(!1),m.resetFields(),k([]),L([]),K(""),Z(!1),ae(null),r(null)},width:600,okText:Y?"Update":"Create",maskClosable:!0,afterClose:function(){r(null)}},U.a.createElement(T.a,{form:m,layout:"vertical"},U.a.createElement(T.a.Item,{name:"pageName",label:"Page Name",rules:[{required:!0,message:"Enter page name"}]},U.a.createElement(O.a,{placeholder:"Enter page name"})),U.a.createElement(T.a.Item,{name:"position",valuePropName:"checked"},U.a.createElement(g.a,null,"Homepage Featured")),U.a.createElement(T.a.Item,{name:"pid",label:"Add PIDs",rules:[{required:!1,message:"Enter PID"}]},U.a.createElement(O.a.Group,{compact:!0},U.a.createElement(O.a,{style:{width:"calc(100% - 80px)"},placeholder:"Enter PID",value:G,onChange:function(e){return K(e.target.value)},onPressEnter:ie}),U.a.createElement(C.a,{type:"primary",onClick:ie,style:{width:"80px"}},"+ Add")),U.a.createElement("div",{style:{marginTop:"8px"}},U.a.createElement(p.a,{fileList:I,onChange:function(e){var t=e.file;if("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===t.type||"application/vnd.ms-excel"===t.type)if(t.size/1024/1024<5){k([t]);var a=new FileReader;a.onload=function(e){try{var t=new Uint8Array(e.target.result),a=q.a(t,{type:"array"});if(0===a.SheetNames.length)return void N.a.error("Excel\u6587\u4ef6\u4e3a\u7a7a\uff01");var n=a.SheetNames[0],r=a.Sheets[n];if(!r||!r["!ref"])return void N.a.error("\u5de5\u4f5c\u8868\u4e3a\u7a7a\uff01");var c=q.b.sheet_to_json(r);if(0===c.length)return void N.a.error("\u672a\u627e\u5230\u6570\u636e\uff01");var l=c.map((function(e){var t=e.pid||e.PID||e.Pid||e.pid||e.PID||e.Pid;return t?String(t).trim():null})).filter((function(e){return null!==e}));if(0===l.length)return void N.a.error("\u672a\u627e\u5230pid\u5217\u6570\u636e\uff01\u8bf7\u786e\u4fddExcel\u6587\u4ef6\u4e2d\u5305\u542bpid\u5217\u3002");var o=Object(P.a)(new Set(l));L((function(e){var t=Object(P.a)(e);return o.forEach((function(e){t.includes(e)||t.push(e)})),t})),N.a.success("\u6210\u529f\u5bfc\u5165 ".concat(o.length," \u4e2aPID"))}catch(i){console.error("Excel\u8bfb\u53d6\u9519\u8bef:",i),N.a.error("\u6587\u4ef6\u8bfb\u53d6\u5931\u8d25\uff01\u8bf7\u786e\u4fdd\u6587\u4ef6\u683c\u5f0f\u6b63\u786e\u3002")}},a.onerror=function(){N.a.error("\u6587\u4ef6\u8bfb\u53d6\u5931\u8d25\uff01\u8bf7\u91cd\u8bd5\u3002")};try{a.readAsArrayBuffer(t)}catch(n){console.error("\u6587\u4ef6\u8bfb\u53d6\u9519\u8bef:",n),N.a.error("\u6587\u4ef6\u8bfb\u53d6\u5931\u8d25\uff01\u8bf7\u91cd\u8bd5\u3002")}}else N.a.error("\u6587\u4ef6\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc75MB\uff01");else N.a.error("\u53ea\u80fd\u4e0a\u4f20Excel\u6587\u4ef6\uff01")},beforeUpload:function(){return!1},accept:".xlsx,.xls",style:{marginBottom:"8px"}},U.a.createElement(C.a,{icon:U.a.createElement(J.a,null)},"Batch Upload PIDs")),U.a.createElement("div",{style:{padding:"8px",border:"1px solid #d9d9d9",borderRadius:"4px",marginTop:"10px",minHeight:"40px",display:"flex",flexWrap:"wrap",gap:"8px",alignItems:"flex-start"}},D.length>0?D.map((function(e,t){return U.a.createElement(d.a,{key:"".concat(e,"-").concat(t),closable:!0,onClose:function(){return t=e,void L((function(e){return e.filter((function(e,a){return e!==t}))}));var t},style:{margin:0}},e)})):U.a.createElement("span",{style:{color:"#999"}},"No PIDs added yet")))),U.a.createElement(T.a.Item,{name:"url",label:"URL",rules:[{required:!1}]},U.a.createElement(O.a,{placeholder:"Enter URL"})))))},W=function(){var e=Object(R.useState)([]),t=Object(w.a)(e,2),a=t[0],n=t[1],c=Object(R.useState)(!1),i=Object(w.a)(c,2),u=i[0],s=i[1],d=Object(R.useState)(null),m=Object(w.a)(d,2),p=m[0],f=m[1],g=Object(R.useState)({search:{}}),E=Object(w.a)(g,2),b=E[0],v=E[1],O=Object(R.useState)({current:1,pageSize:20,total:0}),j=Object(w.a)(O,2),S=j[0],I=j[1];Object(R.useEffect)((function(){N(1,20)}),[]);var N=function(e,t,a,r){s(!0),Object(_.zb)({page:e,pageSize:t,sectionType:a,sectionName:r}).then((function(e){n(null===e||void 0===e?void 0:e.records),I({current:e.current,pageSize:e.size,total:e.total})})).finally((function(){s(!1)}))},P=function(e){f(e)};return U.a.createElement(r.a,{className:"animated fadeIn"},U.a.createElement("style",null,"\n          .custom-input .ant-input {\n            border: none !important;\n          }\n        "),U.a.createElement("div",{className:"web-bread-c"},U.a.createElement(L.a,{arr:["Products Collection"]}),U.a.createElement("h3",null,"Product Collection Management"),U.a.createElement("img",{src:D.a,className:"aset"})),U.a.createElement("div",{className:"base-wr"},U.a.createElement("div",{className:"base-style"},U.a.createElement(V,{changeSearch:function(e){v(Object(o.a)(Object(o.a)({},b),{},{search:Object(o.a)({},e)})),N(1,S.pageSize)},loading:u,onSuccess:function(){return N(1,S.pageSize)},editRecord:p,onEditRecordChange:f,onTypeChange:function(e){N(1,20,e)},onSearch:function(e){return N(1,20,b.search.sectionType,e)}})),U.a.createElement(h.a,null,U.a.createElement(x.a,{span:24},U.a.createElement("div",{className:"base-style"},U.a.createElement(l.a,{columns:[{title:"Page Name",dataIndex:"sectionName",key:"sectionName",align:"center",render:function(e){return e||"-"}},{title:"Product Count",dataIndex:"products",key:"products",align:"center",render:function(e,t){return Array.isArray(t.products)?t.products.length:"0"}},{title:"Position",dataIndex:"sectionType",key:"sectionType",align:"center",render:function(e){return 1===e?"Homepage Featured":"-"}},{title:"URL",dataIndex:"url",key:"url",align:"center",render:function(e){return e?U.a.createElement("a",{href:e,target:"_blank",rel:"noopener noreferrer"},e):"-"}},{title:"Created At",dataIndex:"createTime",key:"createTime",align:"center",render:function(e){return e||"-"}},{title:"Last Updated",dataIndex:"updateTime",key:"updateTime",align:"center",render:function(e){return e||"-"}},{title:"Action",dataIndex:"action",key:"action",align:"center",render:function(e,t){return U.a.createElement(y.a,null,U.a.createElement(C.a,{type:"link",onClick:function(){return P(t)}},"Edit"))}}],rowKey:function(e){return e.id||e.sectionId},dataSource:a,onChange:function(e){N(e.current,e.pageSize,b.search.sectionType)},bordered:!0,loading:u,pagination:S,scroll:{scrollToFirstRowOnChange:!0,x:1e3}}))))))};t.default=W}}]);